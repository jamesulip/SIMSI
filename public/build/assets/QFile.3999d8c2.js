import{j as i,i as Fe,r as T,q as te,k as r,T as de,l as ft,p as ye,ay as mt,C as $e,v as Q,ah as We,y as ht,N as Le,P as gt,V as yt}from"./app.5537cded.js";import{u as bt,a as _t}from"./focus-manager.c162f84c.js";import{u as xt}from"./use-cache.fa61b50a.js";import{a as Ue,i as Ct,j as Dt,u as wt,b as qt,d as St,c as Mt,e as kt,f as Be}from"./use-key-composition.f26dbfe8.js";import{t as Ft,a as Re,f as Vt,g as jt,j as Me,_ as Ht}from"./date.c732528b.js";import{p as ae,h as Ot}from"./format.1bf312ea.js";import{Q as Yt}from"./QDialog.1b717610.js";import{u as Tt,g as It,Q as At}from"./QList.680c6294.js";import{Q as Nt}from"./QChip.b89302f7.js";import{u as Pt}from"./QInput.6a771f70.js";const zt=["gregorian","persian"],pt={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:a=>zt.includes(a),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},Et=["update:modelValue"];function U(a){return a.year+"/"+ae(a.month)+"/"+ae(a.day)}function $t(a,M){const F=i(()=>a.disable!==!0&&a.readonly!==!0),I=i(()=>a.editable===!0?0:-1),m=i(()=>{const h=[];return a.color!==void 0&&h.push(`bg-${a.color}`),a.textColor!==void 0&&h.push(`text-${a.textColor}`),h.join(" ")});function D(){return a.locale!==void 0?{...M.lang.date,...a.locale}:M.lang.date}function x(h){const A=new Date,N=h===!0?null:0;if(a.calendar==="persian"){const H=Ft(A);return{year:H.jy,month:H.jm,day:H.jd}}return{year:A.getFullYear(),month:A.getMonth()+1,day:A.getDate(),hour:N,minute:N,second:N,millisecond:N}}return{editable:F,tabindex:I,headerClass:m,getLocale:D,getCurrentDate:x}}const ee=20,Bt=["Calendar","Years","Months"],Qe=a=>Bt.includes(a),ke=a=>/^-?[\d]+\/[0-1]\d$/.test(a),ue=" \u2014 ";function K(a){return a.year+"/"+ae(a.month)}const na=Fe({name:"QDate",props:{...pt,...Ue,...bt,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:ke},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:ke},navigationMaxYearMonth:{type:String,validator:ke},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:Qe}},emits:[...Et,"rangeStart","rangeEnd","navigation"],setup(a,{slots:M,emit:F}){const{proxy:I}=ye(),{$q:m}=I,D=_t(a,m),{getCache:x}=xt(),{tabindex:h,headerClass:A,getLocale:N,getCurrentDate:H}=$t(a,m);let O;const W=Ct(a),J=Dt(W),R=T(null),c=T(Ie()),b=T(N()),ie=i(()=>Ie()),v=i(()=>N()),w=i(()=>H()),s=T(Ae(c.value,b.value)),k=T(a.defaultView),g=m.lang.rtl===!0?"right":"left",j=T(g.value),p=T(g.value),_=s.value.year,q=T(_-_%ee-(_<0?ee:0)),V=T(null),ve=i(()=>{const e=a.landscape===!0?"landscape":"portrait";return`q-date q-date--${e} q-date--${e}-${a.minimal===!0?"minimal":"standard"}`+(D.value===!0?" q-date--dark q-dark":"")+(a.bordered===!0?" q-date--bordered":"")+(a.square===!0?" q-date--square no-border-radius":"")+(a.flat===!0?" q-date--flat no-shadow":"")+(a.disable===!0?" disabled":a.readonly===!0?" q-date--readonly":"")}),B=i(()=>a.color||"primary"),$=i(()=>a.textColor||"white"),ne=i(()=>a.emitImmediately===!0&&a.multiple!==!0&&a.range!==!0),se=i(()=>Array.isArray(a.modelValue)===!0?a.modelValue:a.modelValue!==null&&a.modelValue!==void 0?[a.modelValue]:[]),d=i(()=>se.value.filter(e=>typeof e=="string").map(e=>xe(e,c.value,b.value)).filter(e=>e.dateHash!==null&&e.day!==null&&e.month!==null&&e.year!==null)),S=i(()=>{const e=t=>xe(t,c.value,b.value);return se.value.filter(t=>mt(t)===!0&&t.from!==void 0&&t.to!==void 0).map(t=>({from:e(t.from),to:e(t.to)})).filter(t=>t.from.dateHash!==null&&t.to.dateHash!==null&&t.from.dateHash<t.to.dateHash)}),Y=i(()=>a.calendar!=="persian"?e=>new Date(e.year,e.month-1,e.day):e=>{const t=Re(e.year,e.month,e.day);return new Date(t.gy,t.gm-1,t.gd)}),X=i(()=>a.calendar==="persian"?U:(e,t,n)=>Vt(new Date(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond),t===void 0?c.value:t,n===void 0?b.value:n,e.year,e.timezoneOffset)),G=i(()=>d.value.length+S.value.reduce((e,t)=>e+1+jt(Y.value(t.to),Y.value(t.from)),0)),Ve=i(()=>{if(a.title!==void 0&&a.title!==null&&a.title.length>0)return a.title;if(V.value!==null){const n=V.value.init,o=Y.value(n);return b.value.daysShort[o.getDay()]+", "+b.value.monthsShort[n.month-1]+" "+n.day+ue+"?"}if(G.value===0)return ue;if(G.value>1)return`${G.value} ${b.value.pluralDay}`;const e=d.value[0],t=Y.value(e);return isNaN(t.valueOf())===!0?ue:b.value.headerTitle!==void 0?b.value.headerTitle(t,e):b.value.daysShort[t.getDay()]+", "+b.value.monthsShort[e.month-1]+" "+e.day}),Ke=i(()=>d.value.concat(S.value.map(t=>t.from)).sort((t,n)=>t.year-n.year||t.month-n.month)[0]),Je=i(()=>d.value.concat(S.value.map(t=>t.to)).sort((t,n)=>n.year-t.year||n.month-t.month)[0]),je=i(()=>{if(a.subtitle!==void 0&&a.subtitle!==null&&a.subtitle.length>0)return a.subtitle;if(G.value===0)return ue;if(G.value>1){const e=Ke.value,t=Je.value,n=b.value.monthsShort;return n[e.month-1]+(e.year!==t.year?" "+e.year+ue+n[t.month-1]+" ":e.month!==t.month?ue+n[t.month-1]:"")+" "+t.year}return d.value[0].year}),fe=i(()=>{const e=[m.iconSet.datetime.arrowLeft,m.iconSet.datetime.arrowRight];return m.lang.rtl===!0?e.reverse():e}),He=i(()=>a.firstDayOfWeek!==void 0?Number(a.firstDayOfWeek):b.value.firstDayOfWeek),Xe=i(()=>{const e=b.value.daysShort,t=He.value;return t>0?e.slice(t,7).concat(e.slice(0,t)):e}),L=i(()=>{const e=s.value;return a.calendar!=="persian"?new Date(e.year,e.month,0).getDate():Me(e.year,e.month)}),Ge=i(()=>typeof a.eventColor=="function"?a.eventColor:()=>a.eventColor),P=i(()=>{if(a.navigationMinYearMonth===void 0)return null;const e=a.navigationMinYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),z=i(()=>{if(a.navigationMaxYearMonth===void 0)return null;const e=a.navigationMaxYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),be=i(()=>{const e={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return P.value!==null&&P.value.year>=s.value.year&&(e.year.prev=!1,P.value.year===s.value.year&&P.value.month>=s.value.month&&(e.month.prev=!1)),z.value!==null&&z.value.year<=s.value.year&&(e.year.next=!1,z.value.year===s.value.year&&z.value.month<=s.value.month&&(e.month.next=!1)),e}),me=i(()=>{const e={};return d.value.forEach(t=>{const n=K(t);e[n]===void 0&&(e[n]=[]),e[n].push(t.day)}),e}),Oe=i(()=>{const e={};return S.value.forEach(t=>{const n=K(t.from),o=K(t.to);if(e[n]===void 0&&(e[n]=[]),e[n].push({from:t.from.day,to:n===o?t.to.day:void 0,range:t}),n<o){let l;const{year:y,month:u}=t.from,f=u<12?{year:y,month:u+1}:{year:y+1,month:1};for(;(l=K(f))<=o;)e[l]===void 0&&(e[l]=[]),e[l].push({from:void 0,to:l===o?t.to.day:void 0,range:t}),f.month++,f.month>12&&(f.year++,f.month=1)}}),e}),ce=i(()=>{if(V.value===null)return;const{init:e,initHash:t,final:n,finalHash:o}=V.value,[l,y]=t<=o?[e,n]:[n,e],u=K(l),f=K(y);if(u!==E.value&&f!==E.value)return;const C={};return u===E.value?(C.from=l.day,C.includeFrom=!0):C.from=1,f===E.value?(C.to=y.day,C.includeTo=!0):C.to=L.value,C}),E=i(()=>K(s.value)),Ze=i(()=>{const e={};if(a.options===void 0){for(let n=1;n<=L.value;n++)e[n]=!0;return e}const t=typeof a.options=="function"?a.options:n=>a.options.includes(n);for(let n=1;n<=L.value;n++){const o=E.value+"/"+ae(n);e[n]=t(o)}return e}),et=i(()=>{const e={};if(a.events===void 0)for(let t=1;t<=L.value;t++)e[t]=!1;else{const t=typeof a.events=="function"?a.events:n=>a.events.includes(n);for(let n=1;n<=L.value;n++){const o=E.value+"/"+ae(n);e[n]=t(o)===!0&&Ge.value(o)}}return e}),tt=i(()=>{let e,t;const{year:n,month:o}=s.value;if(a.calendar!=="persian")e=new Date(n,o-1,1),t=new Date(n,o-1,0).getDate();else{const l=Re(n,o,1);e=new Date(l.gy,l.gm-1,l.gd);let y=o-1,u=n;y===0&&(y=12,u--),t=Me(u,y)}return{days:e.getDay()-He.value-1,endDay:t}}),Ye=i(()=>{const e=[],{days:t,endDay:n}=tt.value,o=t<0?t+7:t;if(o<6)for(let u=n-o;u<=n;u++)e.push({i:u,fill:!0});const l=e.length;for(let u=1;u<=L.value;u++){const f={i:u,event:et.value[u],classes:[]};Ze.value[u]===!0&&(f.in=!0,f.flat=!0),e.push(f)}if(me.value[E.value]!==void 0&&me.value[E.value].forEach(u=>{const f=l+u-1;Object.assign(e[f],{selected:!0,unelevated:!0,flat:!1,color:B.value,textColor:$.value})}),Oe.value[E.value]!==void 0&&Oe.value[E.value].forEach(u=>{if(u.from!==void 0){const f=l+u.from-1,C=l+(u.to||L.value)-1;for(let Se=f;Se<=C;Se++)Object.assign(e[Se],{range:u.range,unelevated:!0,color:B.value,textColor:$.value});Object.assign(e[f],{rangeFrom:!0,flat:!1}),u.to!==void 0&&Object.assign(e[C],{rangeTo:!0,flat:!1})}else if(u.to!==void 0){const f=l+u.to-1;for(let C=l;C<=f;C++)Object.assign(e[C],{range:u.range,unelevated:!0,color:B.value,textColor:$.value});Object.assign(e[f],{flat:!1,rangeTo:!0})}else{const f=l+L.value-1;for(let C=l;C<=f;C++)Object.assign(e[C],{range:u.range,unelevated:!0,color:B.value,textColor:$.value})}}),ce.value!==void 0){const u=l+ce.value.from-1,f=l+ce.value.to-1;for(let C=u;C<=f;C++)e[C].color=B.value,e[C].editRange=!0;ce.value.includeFrom===!0&&(e[u].editRangeFrom=!0),ce.value.includeTo===!0&&(e[f].editRangeTo=!0)}s.value.year===w.value.year&&s.value.month===w.value.month&&(e[l+w.value.day-1].today=!0);const y=e.length%7;if(y>0){const u=7-y;for(let f=1;f<=u;f++)e.push({i:f,fill:!0})}return e.forEach(u=>{let f="q-date__calendar-item ";u.fill===!0?f+="q-date__calendar-item--fill":(f+=`q-date__calendar-item--${u.in===!0?"in":"out"}`,u.range!==void 0&&(f+=` q-date__range${u.rangeTo===!0?"-to":u.rangeFrom===!0?"-from":""}`),u.editRange===!0&&(f+=` q-date__edit-range${u.editRangeFrom===!0?"-from":""}${u.editRangeTo===!0?"-to":""}`),(u.range!==void 0||u.editRange===!0)&&(f+=` text-${u.color}`)),u.classes=f}),e}),at=i(()=>a.disable===!0?{"aria-disabled":"true"}:a.readonly===!0?{"aria-readonly":"true"}:{});te(()=>a.modelValue,e=>{if(O===e)O=0;else{const{year:t,month:n}=Ae(c.value,b.value);le(t,n)}}),te(k,()=>{R.value!==null&&I.$el.contains(document.activeElement)===!0&&R.value.focus()}),te(()=>s.value.year,e=>{F("navigation",{year:e,month:s.value.month})}),te(()=>s.value.month,e=>{F("navigation",{year:s.value.year,month:e})}),te(ie,e=>{Ee(e,b.value,"mask"),c.value=e}),te(v,e=>{Ee(c.value,e,"locale"),b.value=e});function Te(){const e=w.value,t=me.value[K(e)];(t===void 0||t.includes(e.day)===!1)&&De(e),_e(e.year,e.month)}function nt(e){Qe(e)===!0&&(k.value=e)}function lt(e,t){["month","year"].includes(e)&&(e==="month"?Pe:Ce)(t===!0?-1:1)}function _e(e,t){k.value="Calendar",le(e,t)}function ot(e,t){if(a.range===!1||!e){V.value=null;return}const n=Object.assign({...s.value},e),o=t!==void 0?Object.assign({...s.value},t):n;V.value={init:n,initHash:U(n),final:o,finalHash:U(o)},_e(n.year,n.month)}function Ie(){return a.calendar==="persian"?"YYYY/MM/DD":a.mask}function xe(e,t,n){return Ht(e,t,n,a.calendar,{hour:0,minute:0,second:0,millisecond:0})}function Ae(e,t){const n=Array.isArray(a.modelValue)===!0?a.modelValue:a.modelValue?[a.modelValue]:[];if(n.length===0)return Ne();const o=n[n.length-1],l=xe(o.from!==void 0?o.from:o,e,t);return l.dateHash===null?Ne():l}function Ne(){let e,t;if(a.defaultYearMonth!==void 0){const n=a.defaultYearMonth.split("/");e=parseInt(n[0],10),t=parseInt(n[1],10)}else{const n=w.value!==void 0?w.value:H();e=n.year,t=n.month}return{year:e,month:t,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:e+"/"+ae(t)+"/01"}}function Pe(e){let t=s.value.year,n=Number(s.value.month)+e;n===13?(n=1,t++):n===0&&(n=12,t--),le(t,n),ne.value===!0&&he("month")}function Ce(e){const t=Number(s.value.year)+e;le(t,s.value.month),ne.value===!0&&he("year")}function ut(e){le(e,s.value.month),k.value=a.defaultView==="Years"?"Months":"Calendar",ne.value===!0&&he("year")}function rt(e){le(s.value.year,e),k.value="Calendar",ne.value===!0&&he("month")}function it(e,t){const n=me.value[t];(n!==void 0&&n.includes(e.day)===!0?we:De)(e)}function Z(e){return{year:e.year,month:e.month,day:e.day}}function le(e,t){P.value!==null&&e<=P.value.year&&(e=P.value.year,t<P.value.month&&(t=P.value.month)),z.value!==null&&e>=z.value.year&&(e=z.value.year,t>z.value.month&&(t=z.value.month));const n=e+"/"+ae(t)+"/01";n!==s.value.dateHash&&(j.value=s.value.dateHash<n==(m.lang.rtl!==!0)?"left":"right",e!==s.value.year&&(p.value=j.value),$e(()=>{q.value=e-e%ee-(e<0?ee:0),Object.assign(s.value,{year:e,month:t,day:1,dateHash:n})}))}function ze(e,t,n){const o=e!==null&&e.length===1&&a.multiple===!1?e[0]:e;O=o;const{reason:l,details:y}=pe(t,n);F("update:modelValue",o,l,y)}function he(e){const t=d.value[0]!==void 0&&d.value[0].dateHash!==null?{...d.value[0]}:{...s.value};$e(()=>{t.year=s.value.year,t.month=s.value.month;const n=a.calendar!=="persian"?new Date(t.year,t.month,0).getDate():Me(t.year,t.month);t.day=Math.min(Math.max(1,t.day),n);const o=oe(t);O=o;const{details:l}=pe("",t);F("update:modelValue",o,e,l)})}function pe(e,t){return t.from!==void 0?{reason:`${e}-range`,details:{...Z(t.target),from:Z(t.from),to:Z(t.to)}}:{reason:`${e}-day`,details:Z(t)}}function oe(e,t,n){return e.from!==void 0?{from:X.value(e.from,t,n),to:X.value(e.to,t,n)}:X.value(e,t,n)}function De(e){let t;if(a.multiple===!0)if(e.from!==void 0){const n=U(e.from),o=U(e.to),l=d.value.filter(u=>u.dateHash<n||u.dateHash>o),y=S.value.filter(({from:u,to:f})=>f.dateHash<n||u.dateHash>o);t=l.concat(y).concat(e).map(u=>oe(u))}else{const n=se.value.slice();n.push(oe(e)),t=n}else t=oe(e);ze(t,"add",e)}function we(e){if(a.noUnset===!0)return;let t=null;if(a.multiple===!0&&Array.isArray(a.modelValue)===!0){const n=oe(e);e.from!==void 0?t=a.modelValue.filter(o=>o.from!==void 0?o.from!==n.from&&o.to!==n.to:!0):t=a.modelValue.filter(o=>o!==n),t.length===0&&(t=null)}ze(t,"remove",e)}function Ee(e,t,n){const o=d.value.concat(S.value).map(l=>oe(l,e,t)).filter(l=>l.from!==void 0?l.from.dateHash!==null&&l.to.dateHash!==null:l.dateHash!==null);F("update:modelValue",(a.multiple===!0?o:o[0])||null,n)}function st(){if(a.minimal!==!0)return r("div",{class:"q-date__header "+A.value},[r("div",{class:"relative-position"},[r(de,{name:"q-transition--fade"},()=>r("div",{key:"h-yr-"+je.value,class:"q-date__header-subtitle q-date__header-link "+(k.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:h.value,...x("vY",{onClick(){k.value="Years"},onKeyup(e){e.keyCode===13&&(k.value="Years")}})},[je.value]))]),r("div",{class:"q-date__header-title relative-position flex no-wrap"},[r("div",{class:"relative-position col"},[r(de,{name:"q-transition--fade"},()=>r("div",{key:"h-sub"+Ve.value,class:"q-date__header-title-label q-date__header-link "+(k.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:h.value,...x("vC",{onClick(){k.value="Calendar"},onKeyup(e){e.keyCode===13&&(k.value="Calendar")}})},[Ve.value]))]),a.todayBtn===!0?r(Q,{class:"q-date__header-today self-start",icon:m.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:h.value,onClick:Te}):null])])}function qe({label:e,type:t,key:n,dir:o,goTo:l,boundaries:y,cls:u}){return[r("div",{class:"row items-center q-date__arrow"},[r(Q,{round:!0,dense:!0,size:"sm",flat:!0,icon:fe.value[0],tabindex:h.value,disable:y.prev===!1,...x("go-#"+t,{onClick(){l(-1)}})})]),r("div",{class:"relative-position overflow-hidden flex flex-center"+u},[r(de,{name:"q-transition--jump-"+o},()=>r("div",{key:n},[r(Q,{flat:!0,dense:!0,noCaps:!0,label:e,tabindex:h.value,...x("view#"+t,{onClick:()=>{k.value=t}})})]))]),r("div",{class:"row items-center q-date__arrow"},[r(Q,{round:!0,dense:!0,size:"sm",flat:!0,icon:fe.value[1],tabindex:h.value,disable:y.next===!1,...x("go+#"+t,{onClick(){l(1)}})})])]}const ct={Calendar:()=>[r("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[r("div",{class:"q-date__navigation row items-center no-wrap"},qe({label:b.value.months[s.value.month-1],type:"Months",key:s.value.month,dir:j.value,goTo:Pe,boundaries:be.value.month,cls:" col"}).concat(qe({label:s.value.year,type:"Years",key:s.value.year,dir:p.value,goTo:Ce,boundaries:be.value.year,cls:""}))),r("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},Xe.value.map(e=>r("div",{class:"q-date__calendar-item"},[r("div",e)]))),r("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[r(de,{name:"q-transition--slide-"+j.value},()=>r("div",{key:E.value,class:"q-date__calendar-days fit"},Ye.value.map(e=>r("div",{class:e.classes},[e.in===!0?r(Q,{class:e.today===!0?"q-date__today":"",dense:!0,flat:e.flat,unelevated:e.unelevated,color:e.color,textColor:e.textColor,label:e.i,tabindex:h.value,...x("day#"+e.i,{onClick:()=>{dt(e.i)},onMouseover:()=>{vt(e.i)}})},e.event!==!1?()=>r("div",{class:"q-date__event bg-"+e.event}):null):r("div",""+e.i)]))))])])],Months(){const e=s.value.year===w.value.year,t=o=>P.value!==null&&s.value.year===P.value.year&&P.value.month>o||z.value!==null&&s.value.year===z.value.year&&z.value.month<o,n=b.value.monthsShort.map((o,l)=>{const y=s.value.month===l+1;return r("div",{class:"q-date__months-item flex flex-center"},[r(Q,{class:e===!0&&w.value.month===l+1?"q-date__today":null,flat:y!==!0,label:o,unelevated:y,color:y===!0?B.value:null,textColor:y===!0?$.value:null,tabindex:h.value,disable:t(l+1),...x("month#"+l,{onClick:()=>{rt(l+1)}})})])});return a.yearsInMonthView===!0&&n.unshift(r("div",{class:"row no-wrap full-width"},[qe({label:s.value.year,type:"Years",key:s.value.year,dir:p.value,goTo:Ce,boundaries:be.value.year,cls:" col"})])),r("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},n)},Years(){const e=q.value,t=e+ee,n=[],o=l=>P.value!==null&&P.value.year>l||z.value!==null&&z.value.year<l;for(let l=e;l<=t;l++){const y=s.value.year===l;n.push(r("div",{class:"q-date__years-item flex flex-center"},[r(Q,{key:"yr"+l,class:w.value.year===l?"q-date__today":null,flat:!y,label:l,dense:!0,unelevated:y,color:y===!0?B.value:null,textColor:y===!0?$.value:null,tabindex:h.value,disable:o(l),...x("yr#"+l,{onClick:()=>{ut(l)}})})]))}return r("div",{class:"q-date__view q-date__years flex flex-center"},[r("div",{class:"col-auto"},[r(Q,{round:!0,dense:!0,flat:!0,icon:fe.value[0],tabindex:h.value,disable:o(e),...x("y-",{onClick:()=>{q.value-=ee}})})]),r("div",{class:"q-date__years-content col self-stretch row items-center"},n),r("div",{class:"col-auto"},[r(Q,{round:!0,dense:!0,flat:!0,icon:fe.value[1],tabindex:h.value,disable:o(t),...x("y+",{onClick:()=>{q.value+=ee}})})])])}};function dt(e){const t={...s.value,day:e};if(a.range===!1){it(t,E.value);return}if(V.value===null){const n=Ye.value.find(l=>l.fill!==!0&&l.i===e);if(a.noUnset!==!0&&n.range!==void 0){we({target:t,from:n.range.from,to:n.range.to});return}if(n.selected===!0){we(t);return}const o=U(t);V.value={init:t,initHash:o,final:t,finalHash:o},F("rangeStart",Z(t))}else{const n=V.value.initHash,o=U(t),l=n<=o?{from:V.value.init,to:t}:{from:t,to:V.value.init};V.value=null,De(n===o?t:{target:t,...l}),F("rangeEnd",{from:Z(l.from),to:Z(l.to)})}}function vt(e){if(V.value!==null){const t={...s.value,day:e};Object.assign(V.value,{final:t,finalHash:U(t)})}}return Object.assign(I,{setToday:Te,setView:nt,offsetCalendar:lt,setCalendarTo:_e,setEditingRange:ot}),()=>{const e=[r("div",{class:"q-date__content col relative-position"},[r(de,{name:"q-transition--fade"},ct[k.value])])],t=ft(M.default);return t!==void 0&&e.push(r("div",{class:"q-date__actions"},t)),a.name!==void 0&&a.disable!==!0&&J(e,"push"),r("div",{class:ve.value,...at.value},[st(),r("div",{ref:R,class:"q-date__main col column",tabindex:-1},e)])}}}),la=Fe({name:"QPopupProxy",props:{...Tt,breakpoint:{type:[String,Number],default:450}},emits:["show","hide"],setup(a,{slots:M,emit:F,attrs:I}){const{proxy:m}=ye(),{$q:D}=m,x=T(!1),h=T(null),A=i(()=>parseInt(a.breakpoint,10)),{canShow:N}=It({showing:x});function H(){return D.screen.width<A.value||D.screen.height<A.value?"dialog":"menu"}const O=T(H()),W=i(()=>O.value==="menu"?{maxHeight:"99vh"}:{});te(()=>H(),c=>{x.value!==!0&&(O.value=c)});function J(c){x.value=!0,F("show",c)}function R(c){x.value=!1,O.value=H(),F("hide",c)}return Object.assign(m,{show(c){N(c)===!0&&h.value.show(c)},hide(c){h.value.hide(c)},toggle(c){h.value.toggle(c)}}),We(m,"currentComponent",()=>({type:O.value,ref:h.value})),()=>{const c={ref:h,...W.value,...I,onShow:J,onHide:R};let b;return O.value==="dialog"?b=Yt:(b=At,Object.assign(c,{target:a.target,contextMenu:a.contextMenu,noParentEvent:!0,separateClosePopup:!0})),r(b,c,M.default)}}});function re(a,M,F,I){const m=[];return a.forEach(D=>{I(D)===!0?m.push(D):M.push({failedPropValidation:F,file:D})}),m}function ge(a){a&&a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),Le(a)}const Rt={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Qt=["rejected"];function Wt({editable:a,dnd:M,getFileInput:F,addFilesToQueue:I}){const{props:m,emit:D,proxy:x}=ye(),h=T(null),A=i(()=>m.accept!==void 0?m.accept.split(",").map(v=>(v=v.trim(),v==="*"?"*/":(v.endsWith("/*")&&(v=v.slice(0,v.length-1)),v.toUpperCase()))):null),N=i(()=>parseInt(m.maxFiles,10)),H=i(()=>parseInt(m.maxTotalSize,10));function O(v){if(a.value)if(v!==Object(v)&&(v={target:null}),v.target!==null&&v.target.matches('input[type="file"]')===!0)v.clientX===0&&v.clientY===0&&ht(v);else{const w=F();w&&w!==v.target&&w.click(v)}}function W(v){a.value&&v&&I(null,v)}function J(v,w,s,k){let g=Array.from(w||v.target.files);const j=[],p=()=>{j.length>0&&D("rejected",j)};if(m.accept!==void 0&&A.value.indexOf("*/")===-1&&(g=re(g,j,"accept",_=>A.value.some(q=>_.type.toUpperCase().startsWith(q)||_.name.toUpperCase().endsWith(q))),g.length===0))return p();if(m.maxFileSize!==void 0){const _=parseInt(m.maxFileSize,10);if(g=re(g,j,"max-file-size",q=>q.size<=_),g.length===0)return p()}if(m.multiple!==!0&&g.length>0&&(g=[g[0]]),g.forEach(_=>{_.__key=_.webkitRelativePath+_.lastModified+_.name+_.size}),k===!0){const _=s.map(q=>q.__key);g=re(g,j,"duplicate",q=>_.includes(q.__key)===!1)}if(g.length===0)return p();if(m.maxTotalSize!==void 0){let _=k===!0?s.reduce((q,V)=>q+V.size,0):0;if(g=re(g,j,"max-total-size",q=>(_+=q.size,_<=H.value)),g.length===0)return p()}if(typeof m.filter=="function"){const _=m.filter(g);g=re(g,j,"filter",q=>_.includes(q))}if(m.maxFiles!==void 0){let _=k===!0?s.length:0;if(g=re(g,j,"max-files",()=>(_++,_<=N.value)),g.length===0)return p()}if(p(),g.length>0)return g}function R(v){ge(v),M.value!==!0&&(M.value=!0)}function c(v){Le(v),(v.relatedTarget!==null||gt.is.safari!==!0?v.relatedTarget!==h.value:document.elementsFromPoint(v.clientX,v.clientY).includes(h.value)===!1)===!0&&(M.value=!1)}function b(v){ge(v);const w=v.dataTransfer.files;w.length>0&&I(null,w),M.value=!1}function ie(v){if(M.value===!0)return r("div",{ref:h,class:`q-${v}__dnd absolute-full`,onDragenter:ge,onDragover:ge,onDragleave:c,onDrop:b})}return Object.assign(x,{pickFiles:O,addFiles:W}),{pickFiles:O,addFiles:W,onDragover:R,onDragleave:c,processFiles:J,getDndNode:ie,maxFilesNumber:N,maxTotalSizeNumber:H}}const oa=Fe({name:"QFile",inheritAttrs:!1,props:{...wt,...Ue,...Rt,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...qt,...Qt],setup(a,{slots:M,emit:F,attrs:I}){const{proxy:m}=ye(),D=St(),x=T(null),h=T(!1),A=Mt(a),{pickFiles:N,onDragover:H,onDragleave:O,processFiles:W,getDndNode:J}=Wt({editable:D.editable,dnd:h,getFileInput:ve,addFilesToQueue:B}),R=Pt(a),c=i(()=>Object(a.modelValue)===a.modelValue?"length"in a.modelValue?Array.from(a.modelValue):[a.modelValue]:[]),b=i(()=>Be(c.value)),ie=i(()=>c.value.map(d=>d.name).join(", ")),v=i(()=>Ot(c.value.reduce((d,S)=>d+S.size,0))),w=i(()=>({totalSize:v.value,filesNumber:c.value.length,maxFiles:a.maxFiles})),s=i(()=>({tabindex:-1,type:"file",title:"",accept:a.accept,capture:a.capture,name:A.value,...I,id:D.targetUid.value,disabled:D.editable.value!==!0})),k=i(()=>"q-file q-field--auto-height"+(h.value===!0?" q-file--dnd":"")),g=i(()=>a.multiple===!0&&a.append===!0);function j(d){const S=c.value.slice();S.splice(d,1),_(S)}function p(d){const S=c.value.findIndex(d);S>-1&&j(S)}function _(d){F("update:modelValue",a.multiple===!0?d:d[0])}function q(d){d.keyCode===13&&yt(d)}function V(d){(d.keyCode===13||d.keyCode===32)&&N(d)}function ve(){return x.value}function B(d,S){const Y=W(d,S,c.value,g.value),X=ve();X!=null&&(X.value=""),Y!==void 0&&((a.multiple===!0?a.modelValue&&Y.every(G=>c.value.includes(G)):a.modelValue===Y[0])||_(g.value===!0?c.value.concat(Y):Y))}function $(){return[r("input",{class:[a.inputClass,"q-file__filler"],style:a.inputStyle})]}function ne(){if(M.file!==void 0)return c.value.length===0?$():c.value.map((S,Y)=>M.file({index:Y,file:S,ref:this}));if(M.selected!==void 0)return c.value.length===0?$():M.selected({files:c.value,ref:this});if(a.useChips===!0)return c.value.length===0?$():c.value.map((S,Y)=>r(Nt,{key:"file-"+Y,removable:D.editable.value,dense:!0,textColor:a.color,tabindex:a.tabindex,onRemove:()=>{j(Y)}},()=>r("span",{class:"ellipsis",textContent:S.name})));const d=a.displayValue!==void 0?a.displayValue:ie.value;return d.length>0?[r("div",{class:a.inputClass,style:a.inputStyle,textContent:d})]:$()}function se(){const d={ref:x,...s.value,...R.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:B};return a.multiple===!0&&(d.multiple=!0),r("input",d)}return Object.assign(D,{fieldClass:k,emitValue:_,hasValue:b,inputRef:x,innerValue:c,floatingLabel:i(()=>b.value===!0||Be(a.displayValue)),computedCounter:i(()=>{if(a.counterLabel!==void 0)return a.counterLabel(w.value);const d=a.maxFiles;return`${c.value.length}${d!==void 0?" / "+d:""} (${v.value})`}),getControlChild:()=>J("file"),getControl:()=>{const d={ref:D.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:a.tabindex};return D.editable.value===!0&&Object.assign(d,{onDragover:H,onDragleave:O,onKeydown:q,onKeyup:V}),r("div",d,[se()].concat(ne()))}}),Object.assign(m,{removeAtIndex:j,removeFile:p,getNativeElement:()=>x.value}),We(m,"nativeEl",()=>x.value),kt(D)}});export{la as Q,na as a,oa as b};
